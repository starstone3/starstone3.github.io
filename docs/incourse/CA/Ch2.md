# æŒ‡ä»¤çº§å¹¶è¡Œ

å¼€å¤´[æµæ°´çº¿](../Comcompose/Ch4.md#æµæ°´çº¿cpu)åœ¨å‰é¢å­¦è¿‡äº†...

åœ¨è®¡ç»„ä¸­æˆ‘ä»¬å­¦ä¹ çš„æŒ‡ä»¤éƒ½æ˜¯æ•´æ•°æŒ‡ä»¤ï¼Œå®é™…ä¸Šï¼Œå¯¹äºæµ®ç‚¹æŒ‡ä»¤(FP)ï¼Œæµæ°´çº¿éœ€è¦åšä¸€äº›å°æ”¹åŠ¨ã€‚

!!! definition "Latency&Interval"
    - Latency:the number of intervening cycles between an instruction that produces a result and an instruction that uses the result(åœ¨äº§ç”Ÿç»“æœçš„æŒ‡ä»¤å’Œä½¿ç”¨ç»“æœçš„æŒ‡ä»¤ä¹‹é—´çš„å‘¨æœŸæ•°)

    - Interval: the number of cycles that must elapse between the issue of two consecutive instructions(ä¸¤æ¡è¿ç»­æŒ‡ä»¤ä¹‹é—´å¿…é¡»ç»è¿‡çš„å‘¨æœŸæ•°)

åœ¨å¤„ç†æµ®ç‚¹æ•°æ—¶ï¼Œæˆ‘ä»¬æŠŠEXé˜¶æ®µåˆ†ä¸ºå¤šç§ï¼š

- å¤„ç†æµ®ç‚¹æ•°åŠ æ³•

- å¤„ç†æµ®ç‚¹æ•°ä¹˜æ³•

- å¤„ç†æµ®ç‚¹æ•°é™¤æ³•

- ä¸å¤„ç†æµ®ç‚¹æ•°

åœ¨è¿™ä¹‹ä¸­ï¼Œä¹˜æ³•å’ŒåŠ æ³•æ˜¯å¯ä»¥é‡‡å–æµæ°´çº¿çš„æ–¹å¼æ¥å¤„ç†çš„,ä¹Ÿå°±æ˜¯è¯´ï¼Œåä¸€æ¡æŒ‡ä»¤å¹¶ä¸éœ€è¦å‰ä¸€æ¡æŒ‡ä»¤ç¦»å¼€EXé˜¶æ®µæ‰èƒ½è¿›å…¥EXé˜¶æ®µã€‚

---

!!! tip "Out of order Completion"
    å¯¹äºå¦‚ä¸‹æŒ‡ä»¤:
    ```assembly
    fdiv.d F0,F2,F4
    fadd.d F10,F10,F8
    fsub.d F12,F12,F14
    ```

    ç”±äºé™¤æ³•æŒ‡ä»¤æ‰§è¡Œéœ€è¦çš„æ—¶é—´ä¹…ï¼Œå› æ­¤åŠ æ³•å’Œå‡æ³•ä¼šåœ¨é™¤æ³•åšå®Œä¹‹å‰åšå®Œï¼Œä¹Ÿå°±æ˜¯å‡ºç°äº†ä¹±åºçš„ç°è±¡ã€‚

    å¯¹äºä¹±åºï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–å¦‚ä¸‹åšæ³•
    
    1. å¦‚æœåƒä¸Šé¢è¿™æ ·æŒ‡ä»¤ä¹‹é—´ä¸å­˜åœ¨ä¾èµ–ï¼Œé‚£ä¹ˆå¯ä»¥ç›´æ¥å¿½è§†

    2. æŠŠåå®Œæˆçš„æŒ‡ä»¤çš„ç»“æœå­˜åˆ°ä¸€ä¸ªbufferé‡Œé¢ï¼Œç­‰åˆ°å‰é¢çš„æŒ‡ä»¤å®Œæˆåå†å†™å›å»ã€‚

    3. è®°å½•æµæ°´çº¿ä¸­çš„æŒ‡ä»¤ä¸å®ƒä»¬çš„PCå€¼ï¼Œä»¥ä¾¿å¤„ç†å¼‚å¸¸

    4. åªæœ‰å½“ä¸€æ¡æŒ‡ä»¤å‰é¢çš„æŒ‡ä»¤éƒ½å¤„ç†å®Œä¸”æ²¡å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œæ‰å¤„ç†è¿™æ¡æŒ‡ä»¤


---

## ILP exploitation

!!! definition "ILP exploitation"
    ILP exploitation(æŒ‡ä»¤çº§å¹¶è¡Œæ€§åˆ©ç”¨)æ˜¯æŒ‡é€šè¿‡ç¼–è¯‘å™¨å’Œç¡¬ä»¶çš„é…åˆæ¥æé«˜æŒ‡ä»¤çº§å¹¶è¡Œæ€§ã€‚

    - Compiler-based static parallelism:ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶åˆ†ææŒ‡ä»¤ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¹¶å°†å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„æŒ‡ä»¤è¿›è¡Œè°ƒåº¦ã€‚

    - Hardware-based dynamic parallelism:ç¡¬ä»¶åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ†ææŒ‡ä»¤ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¹¶å°†å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„æŒ‡ä»¤è¿›è¡Œè°ƒåº¦ã€‚

ä»€ä¹ˆæ ·çš„æŒ‡ä»¤å¯ä»¥å¹¶è¡Œå‘¢?

å¦‚æœä¸¤æ¡æŒ‡ä»¤ä¸€èµ·æ‰§è¡Œæ—¶ä¸ä¼šæœ‰stallï¼Œä¸ä¼šå¼•èµ·ç»“æ„å†’é™©ï¼Œè¿™ä¸¤æ¡æŒ‡ä»¤å°±æ˜¯å¯ä»¥å¹¶è¡Œçš„ã€‚

ä¸ç„¶ï¼Œæˆ‘ä»¬ç§°è¿™äº›æŒ‡ä»¤æ˜¯æœ‰ä¾èµ–çš„ï¼Œå³Dependant Instructionsã€‚

### Dependence

#### Data Dependence(æ•°æ®ä¾èµ–)

æ•°æ®ä¾èµ–æ˜¯æŒ‡ä¸¤æ¡æŒ‡ä»¤ä¹‹é—´å­˜åœ¨æ•°æ®ä¼ é€’å…³ç³»ï¼Œå³ä¸€æ¡æŒ‡ä»¤çš„è¾“å‡ºç»“æœä½œä¸ºå¦ä¸€æ¡æŒ‡ä»¤çš„è¾“å…¥ã€‚å…¸å‹çš„æ•°æ®ä¾èµ–å°±æ˜¯:

- Read After Write (RAW): ä¹Ÿç§°ä¸ºçœŸå®ä¾èµ–ï¼Œè¡¨ç¤ºç¬¬äºŒæ¡æŒ‡ä»¤éœ€è¦è¯»å–ç¬¬ä¸€æ¡æŒ‡ä»¤çš„ç»“æœã€‚

``` assembly
add r1, r2, r3
sub r4, r1, r5
```

- åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç¬¬äºŒæ¡æŒ‡ä»¤éœ€è¦è¯»å–ç¬¬ä¸€æ¡æŒ‡ä»¤çš„ç»“æœr1ï¼Œå› æ­¤å®ƒä»¬ä¹‹é—´å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»ã€‚

æ€»çš„æ¥è¯´ï¼Œå¦‚æœæŒ‡ä»¤jä¸ä¸æŒ‡ä»¤iæœ‰æ•°æ®ä¾èµ–å…³ç³»ï¼Œé‚£ä¹ˆä¸‹é¢çš„æƒ…å†µéƒ½ä¸èƒ½å‡ºç°ï¼š

- æŒ‡ä»¤jéœ€è¦æŒ‡ä»¤içš„ç»“æœ

- æŒ‡ä»¤jæ•°æ®ä¾èµ–æŒ‡ä»¤kï¼ŒæŒ‡ä»¤kæ•°æ®ä¾èµ–æŒ‡ä»¤i

#### Name Dependence(åç§°ä¾èµ–)

åç§°ä¾èµ–æ˜¯æŒ‡ä¸¤æ¡æŒ‡ä»¤ä¹‹é—´å­˜åœ¨åç§°å†²çªï¼Œå³å®ƒä»¬ä½¿ç”¨äº†ç›¸åŒçš„å¯„å­˜å™¨æˆ–å†…å­˜åœ°å€ï¼Œä½†å®é™…ä¸Šå®ƒä»¬ä¹‹é—´å¹¶æ²¡æœ‰æ•°æ®ä¼ é€’å…³ç³»ã€‚

å…¸å‹çš„åç§°ä¾èµ–æœ‰ä»¥ä¸‹ä¸¤ç§ï¼š

- WAR(Write After Read): ä¹Ÿç§°ä¸ºåä¾èµ–(Antidependence)ï¼Œå³åä¸€æ¡æŒ‡ä»¤å†™å…¥äº†ä¸€ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜åœ°å€ï¼Œè€Œå‰ä¸€æ¡æŒ‡ä»¤è¯»å–äº†è¿™ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜åœ°å€ã€‚

    ```assembly
    fsd r1, 0(r2)
    addi r2,r2,-1
    ```

    - è¿™ä¸¤æ¡æŒ‡ä»¤å®é™…ä¸Šæ²¡æœ‰æ•°æ®ä¾èµ–å…³ç³»,ä½†æ˜¯å®ƒä»¬æ‰§è¡Œçš„é¡ºåºä¸èƒ½äº¤æ¢ï¼Œå› ä¸ºç¬¬äºŒæ¡æŒ‡ä»¤ä¼šè¦†ç›–ç¬¬ä¸€æ¡æŒ‡ä»¤çš„ç»“æœã€‚

- WAW(Write After Write): ä¹Ÿç§°ä¸ºè¾“å‡ºä¾èµ–(Output Dependence)ï¼Œå³ä¸¤æ¡æŒ‡ä»¤éƒ½è¦å†™å…¥åŒä¸€ä¸ªå¯„å­˜å™¨æˆ–å†…å­˜åœ°å€ã€‚

    ``` riscv
    fsd r1, 0(r2)
    fsd r1, 4(r2)
    ```
    
    - åŒæ ·,è¿™ä¸¤æ¡æŒ‡ä»¤æ²¡æœ‰æ•°æ®ä¾èµ–,ä½†ä¸èƒ½äº¤æ¢é¡ºåº.

è¦è§£å†³åç§°ä¾èµ–çš„é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–å¦‚ä¸‹æªæ–½:

- Register Renaming:æŠŠå¯„å­˜å™¨é‡å‘½åä¸ºä¸åŒçš„å¯„å­˜å™¨,è¿™æ ·å°±å¯ä»¥é¿å…åç§°ä¾èµ–çš„é—®é¢˜ã€‚

#### Control Dependence(æ§åˆ¶ä¾èµ–)

æ§åˆ¶ä¾èµ–æ˜¯æŒ‡ä¸¤æ¡æŒ‡ä»¤ä¹‹é—´å­˜åœ¨æ§åˆ¶å…³ç³»ï¼Œå³ä¸€æ¡æŒ‡ä»¤çš„æ‰§è¡Œç»“æœå½±å“äº†å¦ä¸€æ¡æŒ‡ä»¤çš„æ‰§è¡Œã€‚

``` assembly

beq r1, r2, L1

addi r3, r4, 1

L1:
addi r5, r6, 2
```

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç¬¬äºŒæ¡æŒ‡ä»¤çš„æ‰§è¡Œç»“æœå–å†³äºç¬¬ä¸€æ¡æŒ‡ä»¤çš„æ‰§è¡Œç»“æœï¼Œå› æ­¤å®ƒä»¬ä¹‹é—´å­˜åœ¨æ§åˆ¶ä¾èµ–å…³ç³»ã€‚

è¿™ä¸æˆ‘ä»¬è®¡ç»„å­¦çš„Control Hazardæ˜¯ä¸€æ ·çš„ã€‚

---

### Static Scheduling(é™æ€è°ƒåº¦)

!!! definition "Static Scheduling è§£é‡Š from claude"
    é™æ€è°ƒåº¦æ˜¯æŒ‡åœ¨ç¼–è¯‘æ—¶åˆ†ææŒ‡ä»¤ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¹¶å°†å¯ä»¥å¹¶è¡Œæ‰§è¡Œçš„æŒ‡ä»¤è¿›è¡Œè°ƒåº¦ã€‚

    - ä¼˜ç‚¹:ç¼–è¯‘å™¨å¯ä»¥æ ¹æ®æŒ‡ä»¤ä¹‹é—´çš„ä¾èµ–å…³ç³»è¿›è¡Œè°ƒåº¦ï¼Œä»è€Œæé«˜æŒ‡ä»¤çº§å¹¶è¡Œæ€§ã€‚

    - ç¼ºç‚¹:ç¼–è¯‘å™¨æ— æ³•åŠ¨æ€åˆ†ææŒ‡ä»¤ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå› æ­¤å¯èƒ½ä¼šå¯¼è‡´ä¸€äº›æŒ‡ä»¤æ— æ³•å¹¶è¡Œæ‰§è¡Œã€‚

    é™æ€è°ƒåº¦å°±åƒæ˜¯ä¸€ä¸ªç²¾å¿ƒè®¾è®¡çš„äº¤é€šç®¡åˆ¶ç³»ç»Ÿï¼Œä½†è¿™ä¸ªç³»ç»Ÿæ˜¯åœ¨"é“è·¯å»ºè®¾å®Œæˆ"ä¹‹å‰å°±å·²ç»è§„åˆ’å¥½çš„ã€‚

    æƒ³è±¡ç¼–è¯‘å™¨æ˜¯ä¸€ä½äº¤é€šè§„åˆ’å¸ˆï¼Œå®ƒåœ¨ç¨‹åºæ‰§è¡Œå‰ï¼ˆç¼–è¯‘æ—¶ï¼‰å°±éœ€è¦è§„åˆ’å¥½æ‰€æœ‰"è½¦è¾†"ï¼ˆæŒ‡ä»¤ï¼‰çš„è¡Œé©¶è·¯çº¿ï¼š

    1. **æå‰è§„åˆ’è·¯çº¿**ï¼šç¼–è¯‘å™¨ä¼šæå‰æŸ¥çœ‹æ•´ä¸ªä»£ç ï¼Œå°±åƒäº¤é€šè§„åˆ’å¸ˆæŸ¥çœ‹åŸå¸‚åœ°å›¾ï¼Œæ‰¾å‡ºå“ªäº›æŒ‡ä»¤å¯ä»¥å¹¶è¡Œæ‰§è¡Œã€‚

    2. **é¿å¼€"å µè½¦ç‚¹"**ï¼šç¼–è¯‘å™¨ä¼šè¯†åˆ«æŒ‡ä»¤é—´çš„ä¾èµ–å…³ç³»ï¼ˆå¦‚RAWã€WARã€WAWä¾èµ–ï¼‰ï¼Œå°±åƒè§„åˆ’å¸ˆé¿å¼€å¯èƒ½çš„äº¤é€šæ‹¥å µç‚¹ã€‚

    3. **å›ºå®šçš„äº¤é€šç¯è®¾ç½®**ï¼šä¸€æ—¦ç¼–è¯‘å®Œæˆï¼ŒæŒ‡ä»¤æ‰§è¡Œçš„é¡ºåºå°±åƒè¢«å›ºå®šçš„äº¤é€šç¯æ—¶åºä¸€æ ·ï¼Œä¸ä¼šæ ¹æ®å®é™…è¿è¡Œæƒ…å†µåšå‡ºè°ƒæ•´ã€‚

    **å®ä¾‹åˆ†æ**ï¼š
    ```c
    a = b + c;    // æŒ‡ä»¤1
    d = e + f;    // æŒ‡ä»¤2 
    g = a + d;    // æŒ‡ä»¤3
    ```

    é™æ€è°ƒåº¦åˆ†æï¼š

    - æŒ‡ä»¤1å’ŒæŒ‡ä»¤2ä¹‹é—´æ²¡æœ‰ä¾èµ–ï¼Œå¯ä»¥å¹¶è¡Œæ‰§è¡Œ

    - æŒ‡ä»¤3ä¾èµ–äºæŒ‡ä»¤1å’ŒæŒ‡ä»¤2çš„ç»“æœï¼Œå¿…é¡»ç­‰å®ƒä»¬å®Œæˆåæ‰èƒ½æ‰§è¡Œ

    ç¼–è¯‘å™¨ä¼šç”Ÿæˆè°ƒåº¦è®¡åˆ’ï¼šå…ˆå¹¶è¡Œæ‰§è¡ŒæŒ‡ä»¤1å’ŒæŒ‡ä»¤2ï¼Œå†æ‰§è¡ŒæŒ‡ä»¤3ã€‚è¿™ç§è§„åˆ’æ˜¯åŸºäºç¼–è¯‘æ—¶çš„"ç†æƒ³æƒ…å†µ"åšå‡ºçš„æœ€ä½³å®‰æ’ï¼Œä½†æ— æ³•åº”å¯¹è¿è¡Œæ—¶çš„æ„å¤–æƒ…å†µï¼Œå¦‚ç¼“å­˜æœªå‘½ä¸­æˆ–åˆ†æ”¯é¢„æµ‹é”™è¯¯ã€‚


é™æ€è°ƒåº¦æœ‰ä¸¤ç§æ–¹æ³•:

1. Pipeline Scheduling:æµæ°´çº¿è°ƒåº¦

2. Loop Unrolling:å¾ªç¯å±•å¼€

æˆ‘ä»¬ä»¥æ¥ä¸‹æ¥è¿™æ®µç¨‹åºä¸ºä¾‹ä»‹ç»ã€‚

```c
for(i=999;i>=0;i--){
    x[i] = x[i] + s;
}
```

å®ƒçš„RISC-VæŒ‡ä»¤å¦‚ä¸‹:

```assembly
Loop: fld f0,0(x1) // load x[i] into f0
      fadd.d f4,f0,f2 // f0 = x[i] + s
      fsd f4,0(x1) // store f0 into x[i]
      addi x1,x1,-8 // i--
      bne x1,x2,Loop // if i != 0, jump to Loop
```

---

#### Pipeline Scheduling(æµæ°´çº¿è°ƒåº¦)

è§‚å¯Ÿä¸Šé¢çš„æ±‡ç¼–æŒ‡ä»¤ï¼Œæˆ‘ä»¬å‘ç°å‰ä¸‰æ¡æŒ‡ä»¤éƒ½å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»ã€‚

å¦‚æœå°±è¿™æ ·æ‰§è¡Œçš„è¯

1. `fld`æŒ‡ä»¤å’Œ`fadd.d`æŒ‡ä»¤ä¹‹é—´éœ€è¦ä¸€ä¸ªå‘¨æœŸçš„stall(è€ƒè™‘forwarding)

2. `fadd.d`æŒ‡ä»¤å’Œ`fsd`æŒ‡ä»¤ä¹‹é—´éœ€è¦ä¸¤ä¸ªå‘¨æœŸçš„stall

è¿™æ ·,è·‘ä¸€ä¸ªå¾ªç¯å°±è¦å…«ä¸ªå‘¨æœŸ.

å¦‚æœæˆ‘ä»¬æŠŠæŒ‡ä»¤é¡ºåºè°ƒæ•´ä¸º

```assembly
Loop: fld f0,0(x1) // load x[i] into f0
      addi x1,x1,-8 // i--
      fadd.d f4,f0,f2 // f0 = x[i] + s
      fsd f 8(x1) // store f0 into x[i]
      bne x1,x2,Loop // if i != 0, jump to Loop
```

åœ¨è¿™æ ·çš„æƒ…å†µä¸‹,`fld`å’Œ`fadd.d`ä¹‹é—´å°±ä¸ç”¨åœäº†,å› ä¸ºè¿™ä¸€ä¸ªå‘¨æœŸæ‹¿æ¥æ‰§è¡Œæ— å…³çš„æŒ‡ä»¤äº†,ç°åœ¨åªéœ€è¦åœ¨`fadd.d`å’Œ`fsd`ä¹‹é—´åœä¸¤ä¸ªå‘¨æœŸå°±è¡Œäº†.

è·‘ä¸€ä¸ªå¾ªç¯ä»å…«ä¸ªå‘¨æœŸå˜æˆäº†ä¸ƒä¸ªå‘¨æœŸ,åŠ å¿«äº†é€Ÿåº¦.

---

ç„¶è€Œ,ç°åœ¨è¿˜å­˜åœ¨ä¸€ä¸ªé—®é¢˜.åœ¨ä¸€ä¸ªå¾ªç¯ä¸­,çœŸæ­£å¯¹æ•°æ®ä½œæ“ä½œçš„å°±åªæœ‰`fld`,`fadd.d`å’Œ`fsd`ä¸‰æ¡æŒ‡ä»¤,äº”æ¡æŒ‡ä»¤åªæœ‰ä¸‰æ¡åœ¨å¹²æ´»,è¿™ä¸ç¬¦åˆæˆ‘ä»¬çš„è®¾è®¡.

å› æ­¤,å¼•å…¥äº†Loop Unrolling(å¾ªç¯å±•å¼€).

---

#### Loop Unrolling(å¾ªç¯å±•å¼€)

æˆ‘ä»¬æŠŠç”¨äºå¾ªç¯çš„è¯­å¥å¼€é”€ç§°ä¸ºLoop Overhead(å¾ªç¯å¼€é”€),å®ƒåŒ…æ‹¬:

- è®¡ç®—å¾ªç¯æ¡ä»¶çš„å¼€é”€

- æ›´æ–°å¾ªç¯å˜é‡çš„å¼€é”€

- è·³è½¬çš„å¼€é”€

æˆ‘ä»¬çš„ç›®çš„å°±æ˜¯é™ä½è¿™ä¸ªå¼€é”€,ä¹Ÿå°±æ˜¯æé«˜å¹²æ´»æŒ‡ä»¤çš„æ¯”ä¾‹.

æˆ‘ä»¬ç›´æ¥æŠŠå¾ªç¯å±•å¼€å››æ¬¡:

```assembly
Loop:   fld f0,0(x1) // load x[i] into f0
        fadd.d f4,f0,f2 // f0 = x[i] + s
        fsd f4,0(x1) // store f0 into x[i]
        fld f6,-8(x1) // load x[i-1] into f6
        fadd.d f8,f6,f2 // f6 = x[i-1] + s
        fsd f8,-8(x1) // store f6 into x[i-1]
        fld f10,-16(x1) // load x[i-2] into f10
        fadd.d f12,f10,f2 // f10 = x[i-2] + s
        fsd f12,-16(x1) // store f10 into x[i-2]
        fld f14,-24(x1) // load x[i-3] into f14
        fadd.d f16,f14,f2 // f14 = x[i-3] + s
        fsd f16,-24(x1) // store f14 into x[i-3]
        addi x1,x1,-32 // i--
        bne x1,x2,Loop // if i != 0, jump to Loop
```

è¿™æ ·,å¹³å‡æ¯ä¸ªå¾ªç¯è€—æ—¶6.5ä¸ªå‘¨æœŸ.

> ğŸ’¡ **æ€§èƒ½ä¼˜åŒ–æ–°æŒ‘æˆ˜**  
> ä½†æ˜¯è¿˜ä¸è¿‡ç˜¾ï¼æˆ‘ä»¬æƒ³è¦æ›´è¿›ä¸€æ­¥ï¼Œæ€ä¹ˆåšï¼Ÿ

æˆ‘ä»¬å¯ä»¥å†è¿›è¡Œé‡æ’æ¥å‡å°‘å‘¨æœŸæ•°ã€‚

```assembly
Loop:   fld f0,0(x1) // load x[i] into f0
        fld f6,-8(x1) // load x[i-1] into f6
        fld f10,-16(x1) // load x[i-2] into f10
        fld f14,-24(x1) // load x[i-3] into f14
        fadd.d f4,f0,f2 // f0 = x[i] + s
        fadd.d f8,f6,f2 // f6 = x[i-1] + s
        fadd.d f12,f10,f2 // f10 = x[i-2] + s
        fadd.d f16,f14,f2 // f14 = x[i-3] + s
        fsd f4,0(x1) // store f0 into x[i]
        fsd f8,-8(x1) // store f6 into x[i-1]
        fsd f12,-16(x1) // store f10 into x[i-2]
        fsd f16,-24(x1) // store f14 into x[i-3]
        addi x1,x1,-32 // i--
        bne x1,x2,Loop // if i != 0, jump to Loop
```

è¿™æ ·,æˆ‘ä»¬ç”¨æœ‰ç”¨çš„æŒ‡ä»¤ä»£æ›¿äº†stall,æ‰€ä»¥å®Œå…¨ä¸éœ€è¦åœäº†.

å››ä¸ªå¾ªç¯ä¸€å…±ç”¨äº†14ä¸ªå‘¨æœŸ,å¹³å‡æ¯ä¸ªå¾ªç¯3.5ä¸ªå‘¨æœŸ,æå‡å¯ä»¥è¯´éå¸¸å¤§äº†.

---